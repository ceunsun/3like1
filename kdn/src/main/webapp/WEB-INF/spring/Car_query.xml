<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
	
<mapper namespace="car">
	<select id="getCount" parameterType="String" resultType="int" >
		SELECT count(*) count
		FROM car
		WHERE carname = #{carname} and carstatus='예약가능'
	</select>
	
	<select id="availableSearch" parameterType="String" resultType="car">
		SELECT *
		FROM car
		WHERE carname = #{carname} and carstatus='예약가능'
	</select>
	
	<select id="returnSearch" resultType="return">
		SELECT returnno, to_char(returndate, 'yyyy-mm-dd') returndate, memberno, carno
		FROM return
	</select>
	
	<select id="rentSearch" resultType="rent">
		SELECT rentno, 
				to_char(rentdate, 'yyyy-mm-dd') rentdate, 
				to_char(returndate, 'yyyy-mm-dd') returndate, 
				memberno, 
				carno
		FROM rent
	</select>
	
	<select id="reserveSearch" resultType="reservation"> 
		SELECT reserveno, 
			   carno, 
			   memberno,
			   TO_CHAR(startdate, 'yyyy-mm-dd') startdate, 
			   TO_CHAR(enddate, 'yyyy-mm-dd') enddate 
		FROM RESERVATION  
	</select>

	<select id="accidentSearch" resultType="accident"> 
		SELECT * 
		FROM accident 
	</select>
	
	<insert id="reserve" parameterType="reservation">		
		INSERT INTO reservation 
		VALUES(reservation_seq.nextval, #{startdate}, #{enddate}, #{carno}, #{memberno})
	</insert>
</mapper>